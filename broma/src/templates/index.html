<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reproducción automática (intento)</title>
  <style>
    :root { --bg:#0f1724; --fg:#e6eef8; --accent:#ff6b6b; }
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{
      display:flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg,#071029 0%, #0f1724 100%);color:var(--fg);
      text-align:center;padding:20px;
    }
    .card{max-width:680px;padding:28px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,.6);background:rgba(255,255,255,0.03)}
    h1{margin:0 0 10px;font-size:20px}
    p{margin:0 0 18px;color:#cbd7e6}
    button{
      appearance:none;border:0;padding:12px 20px;border-radius:10px;font-size:16px;
      background:var(--accent);color:white;cursor:pointer;
      box-shadow:0 6px 18px rgba(255,107,107,.18);
    }
    #overlay{
      position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
      background:rgba(2,6,23,0.6);backdrop-filter:blur(4px);z-index:60;visibility:hidden;opacity:0;
      transition:opacity .18s, visibility .18s;
    }
    #overlay.show{visibility:visible;opacity:1}
    #muted-note{font-size:14px;color:#ffdcdc;margin-top:8px}
    footer{margin-top:14px;font-size:13px;color:#94a3b8}
  </style>
</head>
<body>
  <div class="card">
    <h1>Reproducción automática (intento)</h1>
    <p>La página intentará reproducir un audio al entrar y ponerlo al 100% de volumen. Si el navegador lo bloquea, haz clic en el botón grande.</p>

    <div>
      <button id="manualPlayBtn" style="display:none">Reproducir ahora (activar sonido)</button>
    </div>

    <footer>Archivo de audio: <span id="srcName">audio.mp3</span></footer>
  </div>

  <!-- audio: cambia src por tu archivo real -->
  <audio id="player" src="../media/audio/sonido-de-gemidos-broma-made-with-Voicemod.mp3" preload="auto" loop playsinline></audio>

  <div id="overlay">
    <div style="background:#071027;padding:26px;border-radius:12px;max-width:520px;color:var(--fg);text-align:center;">
      <h2 style="margin:0 0 8px">Se requiere interacción</h2>
      <p style="margin:0 0 16px">El navegador bloqueó la reproducción automática con sonido. Pulsa el botón para permitir audio a todo volumen.</p>
      <button id="overlayPlay">Activar audio</button>
      <div id="muted-note">Si después de pulsar sigues sin oír nada, revisa el volumen del sistema o del dispositivo.</div>
    </div>
  </div>

  <script>
    (function(){
      const player = document.getElementById('player');
      const overlay = document.getElementById('overlay');
      const overlayPlay = document.getElementById('overlayPlay');
      const manualBtn = document.getElementById('manualPlayBtn');
      const srcName = document.getElementById('srcName');

      // Muestra el nombre del archivo si hay src
      try { srcName.textContent = player.src ? player.src.split('/').pop() : 'audio.mp3' }catch(e){}

      // Fuerza volumen a 1.0 (100%)
      function setFullVolume() {
        try {
          player.volume = 1.0; // 0.0 - 1.0
          player.muted = false;
        } catch(e) {
          // algunos navegadores/elementos no permiten cambiar el volumen programáticamente en ciertos contextos
          console.warn('No se pudo ajustar el volumen programáticamente:', e);
        }
      }

      // Intento automático al cargar
      window.addEventListener('load', async () => {
        setFullVolume();
        try {
          await player.play();
          console.log('Audio reproduciéndose automáticamente (si el navegador lo permite).');
        } catch(err) {
          // Autoplay bloqueado: mostramos overlay y botón grande
          console.warn('Autoplay bloqueado, se requiere interacción del usuario.', err);
          overlay.classList.add('show');
          manualBtn.style.display = 'inline-block';
        }
      });

      // Al hacer clic, ponemos volumen al 100% y reproducimos
      function userStart() {
        setFullVolume();
        // un pequeño retraso da tiempo al SO/dispositivo a aceptar el cambio de volumen
        player.play().then(()=> {
          overlay.classList.remove('show');
          manualBtn.style.display = 'none';
        }).catch(e=>{
          console.error('Error al reproducir tras la interacción:', e);
          // mantener overlay visible
        });
      }

      overlayPlay.addEventListener('click', userStart);
      manualBtn.addEventListener('click', userStart);

      // Atajos: si el usuario toca la pantalla en cualquier sitio, intentamos reproducir
      document.addEventListener('click', function tryPlayOnAnyClick(e){
        if (!player.paused) return; // si ya reproduce no necesitamos
        userStart();
        // quitamos el listener para no molestar
        document.removeEventListener('click', tryPlayOnAnyClick);
      }, { once: false });

    })();
  </script>
</body>
</html>
